\section{Обобщённые функции}
Введём некоторые обозначения. $\R^n\ni x=(x_1,\dots,x_m),\ x_k\in\R$. Здесь есть норма $\|x\| = \sqrt{\la x,x\ra} = \RY k1n x_k\,y_k$. $\F \in\{\R,\C\}$. 
\begin{Def} Пространством бесконечно дифференцируемые функции с компактным носителем называется\label{c08}
\[
  C_0^\infty(X) = \big\{\phi\colon \R^n\to\F\bigm|\exists\ \dl^\a\phi(x),\ \supp(\phi)\Subset X\big\}.
\]
 В нём водится сходимость по системе норм $p_k(\phi) = \sum\limits_{|\alpha|\le k}\sup\limits_{x\in X}\big|\dl^\a\phi(x)\big|$ для $k=0,1,\dots$ Если $X$ является компактным, то $C_0^\infty$ будет полным, то есть пространством Фреше\footnote{Пространстами Фреше называют полные счётно нормированные.}.
\end{Def}

\subsection{Примеры бесконечно дифференцируемых функций}
Приведём несколько примеров бесконечно дифференцируемых функций, которые нам понадобятся в дальнейшем.
\begin{enumerate}
\item Рассмотрим функцию
\[
  e(t) = \begin{cases}
e^{-\frac 1t},&t>0;\\
0,&t\le0.
\end{cases}
\]
Это бесконечно дифференцируемая функция, $e(t)\ge0$,  $\supp(e) = \R_+$. Дифференцируемость в нуле проверяется по правилу Лопиталя.
\item $\xi(x) = e\big(1-\|x\|^2\big)$, $\|x\|^2 = \RY k1mx_k^2$, $\supp(\xi) = S$, где
\[
  S = \big\{x\in\R^m\bigm|\|x\|\le1\big\}
\]
единичный шар.

\item Система функций $\theta_r(x) = c_r\,\xi\left(\frac xr\right)$ для $r>0$. Константу $c_r$ выбираем так, чтобы $\Gint{\R^m}\theta_r(x)\,dx=1$.
Называется аппроксимативной единицей. Все бесконечно дифференцируемы и $\supp(\theta_r) = S_r = \big\{x\in\R^m\bigm|\|x\|\le r\big\}$.
\item $\eta(x) = \Gint{S_2}\theta_1(x-y)\,dy$. Легко проверить, что эта функция \begin{itemize}
\item $\eta\in C_0^\infty(\R^m)$;
\item $\supp(\eta) = S_3$;
\item $\eta(x)=1$ на $x\in S_1$, $\eta(x)=0$ вне $S_3$. И принимает значения между нулём и единицей на разности $S_3\dd S_1$.
\end{itemize}
\end{enumerate}
\subsection{Пространство основных функций}
Перейдём к определению обобщённых функций.
\begin{Def}
  $\D(X)$ "--- пространство основных функций. В $\D(X)\subset C_0^\infty(X)$ определена сходимость $\phi_n\to\phi$, если
\begin{roItems}
  \item $\forall\ \alpha\in\Z_+^m\pau \dl^\alpha\phi_n\rsh[ ]{n}\dl^\a\phi$ на $X$,
\item $\exists\ K\Subset X\colon \forall\ n\in\N\pau \supp(\phi_n)\subset K$.
\end{roItems}
\end{Def}

\begin{Def}
  Сопряжённое пространство $\D'(X)$ к пространству сходимости $\D(X)$ называется пространством обобщённых функций.
\end{Def}

Как мы и определяли сопряжённое пространство "--- это множество всех линейных непрерывных функционалов. Непрерывность понимается относительно сходимости в $\D(X)$. Обобзначение $\la f,\phi\ra$ для $f\in \D'(X)$  и $\phi\in\D(X)$.

Свойства.
\begin{roItems}
  \item $f\in\D'(X)$ обязательно линейная функция, то есть
\[
  \forall\ \l_1,\l_2\in\F,\ \forall\ \phi_1,\phi_2\in\D(X)\pau 
  \la f,\l_1\phi_1+\l_2\phi_2\ra =\l_1\la f,\phi_1\ra +\l_2\la f,\phi_2\ra.
\]
\item $f$ "--- непрерывный функционал в $\D(X)$, то есть если $\phi_n\to \phi$ в $\D(X)$, то и $\la f,\phi_n\ra\to\la f,\phi\ra$.
\item Если $f_n\to f,\ f_n\in\D'(X)$, то $f\in\D'(X)$. При этом сходимость в $D'(X)$ это просто поточечная сходимость: $\forall\ \phi\in\D(X)\pau \la f_n,\phi\ra\to \la f,\phi\ra$.
Это вытекает из теоремы о полноте сопряжённого пространства к~пространству сходимости, которую мы доказали на прошлой лекции.
\end{roItems}

\begin{Exa}
 $\delta(x-a)$ "--- $\delta$-функция. Определяется по формуле
\[
  \forall\ \phi\in\D(\R^m)\pau \la\delta(x-a),\phi\ra:=\phi(a).
\]
Очевидно, что $\delta(x-a)\in\D'(\R^m)$.
\end{Exa}

\begin{Exa}
$\mathcal P\frac1x$ "--- главное значение $\frac1x$. Определяется на $\D(\R)$ по формуле
\[
  \forall\ \phi\in\D(\R)\pau 
  \left\la\mathcal P\frac1x,\phi\right\ra = 
  \yo\e{0+}\Gint{\|x\|\ge\e}\frac{\phi(x)}x\,dx = 
  \int\limits_0^\infty\frac{\phi(x)-\phi(-x)}x\,dx.
\]
\end{Exa}


\subsection{Действия с обобщёнными функциями}
\begin{enumerate} \item
Функция называется локально интегрируемой, если интегрируема по Лебегу на каждом компакте. Обозначают $\Lloc(X)$. Такие $\phi\colon \R^m\to\F$ и $\forall\ K\Subset X\pau \phi\in\L_1(K)$. Тогда для $f\in \Lloc(\R)$ можно определить обобщённую функцию
\[
  \forall\ \phi\in\D(X)\pau \la f,\phi\ra:=\Gint{X} f(x)\phi(x)\,dx.
\]
Непрерывность вытекает из теоремы Лебега о предельном переходе.

\item Если $\psi\in C^\infty(X)$ и $f\in\D'(X)$, то
\[
  \forall\ \phi\in \D(X)\pau \la\psi\cdot f,\phi\ra:=\la f,\psi\,\phi\ra.
\]

Оператор $M_\psi:=\psi\cdot\phi$ непрерывен в $\D(X)$. Значит, $\psi\,f\in\D'(X)$.

\item Пусть $\tau_a\,\phi(x):=\phi(x-a)$ и  оператор растяжения $\rho_\lambda\,\phi(x):=\phi(\lambda\, x)$. Если $f\in\D'(\R^m)$, то определяются следующие обобщённые функции 
\[
\la\tau_a f,\phi\ra:=\la f,\tau_a\phi\ra;\quad
 \la\rho_\l f,\phi\ra:=|\lambda|^{-m}\la f,\rho_{\l^{-1}}\phi\ra,\quad\l\in\R\dd\{0\}.
\]
Линейность очевидна, а непрерывность обобщённых функций следует из непрерывности операторов.
\item Пусть у нас есть линейное преобразование $A\colon \R^m\to\R^m$ (или линейный оператор на пространстве $\R^m$), у которого определитель $\det A\ne0$. Определим оператор замены переменных $T_A\phi(x) = \phi(A\,x)$. Тогда определяется оператор замены переменных для обобщённых функций.
\[
  \la T_Af,\phi\ra = |\det A|^{-1}\la f,T_{A^{-1}}\phi\ra.
\]
Непрерывность этого функционала вытекает из непрерывность этого оператора в пространстве $\D(X)$. Если частные производные сходятся равномерно, то и частные производные функции-образа будут сходиться равномерно.

\item Пусть $f\in\D'(X)$. Частная производная порядка $\a\in\Z_+^m$ определяется по формуле
\[
  \la\dl^\a f,\phi\ra:=(-1)^{|\a|}\la f,\dl^\a\phi\ra.
\]
Если $\phi_n\to\phi$ в $\D(X)$, то и $\dl^\a\phi_n\rsh[ ]{n}\dl^\a\phi$ в $\D(X)$. Значит, $\dl^\a f\in\D'(X)$.
\end{enumerate}
\begin{Ut}[Формула Лейбница]
  Пусть $\dl_k = \CP{ }{x_k}$ для $k=1,\dots,m$. Тогда
\[
  \dl_k(\psi\cdot f) = (\dl_k\psi)f+\psi(\dl_k\,f),\quad f\in \D'(X),\ \psi\in C_0^\infty(X).
\]
  Имеем по формуле Лейбница для обычных функций и определению производной для обобщённой функции.
\[
  \big\la \dl_k(\psi f),\phi\big\ra = -\big\la f,\psi(\dl_k\phi)\big\ra = 
  \big\la f,(\dl_k\psi)\phi\big\ra - \big\la f,\dl_k(\psi\phi)\big\ra = 
  \big\la(\dl_k\psi)f,\phi\big\ra + \big\la\psi(\dl_kf),\phi\big\ra.
\]
\end{Ut}

\begin{The}[о локальной структуре]
  Пусть у нас $X\subset \R^m$ ограниченное замкнутое множество\footnote{В определении обобщённых функций, которое мы с вами дали $X$ всегда открытое множество. В данном случае оно будет ещё и ограничено. Тогда можно представить формулой любую обобщённую функцию.}.
Тогда (здесь $C(X)$ пространство непрерывных ограниченных)
\[
  \forall\ f\in\D'(X)\pau \exists\ \a\in\Z_+^m,\ \exists\ g\in C(X)\colon f = \dl^\a g,
\]
то есть 
\[
  \forall\ \phi\in\D(X)\pau
  \la f,\phi\ra = (-1)^{|\a|}\Gint Xg(x)\dl^\a\phi(x)\,dx.
\]
\end{The}
\begin{Proof}
Для простоты мы будем считать, что $X\subset[0,1]^m$. 
Кстати, это легко получить в результате применения операции замены переменных.
Из непрерывности $f$ существует 
\[
  \exists\ c>0,\ \exists\ k\in\N\colon \forall\ \phi\in\D(X)\pau \big|\la f,\phi\ra\big|\le c\,p_k(\phi).\]
Это вытекает из того, что $f$ непрерывен на $D(X)$, а значит, он непрерывен и в $C_0^\infty$, где сходимость задаётся такими полунормами
\[
  p_k(\phi) = \sum\limits_{|\a|\le k}\sup\limits_{x\in X}\big|\dl^\a\phi(x)\big|.
\]
Мы с вами доказали на прошлой лекции эквивалентность непрерывности и ограниченности. Оттуда и вытекает неравенство.

При этом $p_0(\phi) = \sup\limits_{x\in X}\big|\phi(x)\big|$. По формуле Лагранжа (о среднем значении, то есть теорема Лагранжа) для $l=1,2,\dots,m$
\[
  p_0(\phi)\le p_0(\dl_l\phi)ю
\]
Обозначим $D = \dl_1\dots\dl_m$. Тогда можем записать такое неравенство
\begin{multline*}
  \exists\ c_k>0\colon \forall\ |\alpha|\le k\pau p_\alpha(\phi)\le c_k p_0(D^k\phi)\overset{\text{Н--Л}}= c_kp_0 \bigg( \Gint{[0,x_1]\times\dots\times[0,x_m]}D^{k+1}\phi(y)\,dy\bigg)\le
c_k\Gint{[0,1]^m} \big|D^{k+1}\phi(x)\big|\,dx\le\\
\cmt{применяем неравенство Коши"--~Буняковского}\\
\le c_k\big\|D^{k+1}\phi\big\|_{\L_2}.
\end{multline*}
За конечной суммой будет некоторая константа.

Из последнего неравенства вытекает, что
\[
  \forall\ \phi\in \D(x)\pau \big|\la f,\phi\ra\big|\le c_k\big\|D^{k+1}\phi\big\|_{\L_2}.
\]

Рассмотрим оператор $A\colon D^{k+1}\colon D(X)\to D(X)$. Он является взаимнооднозначным, то есть биективным, так как пространства функций с компактным носителем и там нет констант (у оператора ядро равно нулю, если и только если он биективен). И определим функционал $F(\psi):=\la f,A^{-1}\psi\ra$, где $\psi = A\phi$, а $\phi\in\D(X)$. Из нашего неравенства вытекает, ограниченность в $\L_2$, то есть
\[
  \big|F(\psi)\big|\le c_k\|\psi\|_{\L_2}
\]
Можем продолжить этот функционал по теореме Хана"--~Банаха.

Так как $\L_2$ "--- гильбертово пространство, можно применить теорему Рисса для гильбертова пространства. Значит, этот функционал представляется в виде скалярного произведения. А в $\L_2$ "--- это интеграл
\[
  \exists\ h\in\L_2\colon F(\psi) = \Gint Xh(x)\psi(x)\,dx.
\]

Доопределим $h(x)=0$ для $x\not\in X$. Тогда при интегрировании по частям (оно нужно для получения непрерывной функции) неинтегральных членов не будет.
\[
  \la f,\phi\ra = \Gint X h(x) D^{k+1}\phi(x)\,dx = 
  (-1)^{|\a|}\Gint Xg(x)\dl^\a\phi(x)\,dxб
\]
где $g(x) = (-1)^{|\a|+m}\Gint{\Delta_x}h(y)\,dy$, $\a = (k+2,\dots,k+2)$.

Ну и теорема доказана.
\end{Proof}

Что мы понимаем под равенством двух обобщённых функций?
\begin{Def}
Заданы две обобщённые функции $f,g\in\D'(X)$. Они равны $f=g$, если
\[
  \forall\ \phi\in\D(X)\pau \la f,\phi\ra = \la g,\phi\ra,
\]
то есть если равны соответствующие линейные функционалы на определённом множестве.

Можно определить равенство функционалов $f(x)=g(x)$ в точке $x\in X$, если $\exists$ окрестность $O_x\subset X$ точки $x$, для которой
\[
  \forall\ \phi\in \D(X)\colon \supp \phi\Subset O_x\pau \la f,\phi\ra = \la g,\phi\ra.
\]
Если перебрать все обобщённые функции, совпадающие в точке, нужно брать объёдинение всех окрестностей "--- это открытое множество. Значит, обобщённые функции совпадают на открытом множестве.
\end{Def}

\begin{Def}
 Пусть $f\in\D'(X)$. Тогда $\supp(f) = \big\{x\in X\bigm|f(x)\ne0\big\}$.
\end{Def}
Это множество замкнуто в $X$ (существует замкнутое множество в $\R^n$, которое при пересечение с $X$ даёт наше).

Приведём теорему без доказательства.
\begin{The}[о структуре обобщённой функции с носителем в одной точке]
  Если $f\in\D'(X)$ и $\supp(x) = \{a\}\subset X$, то $\exists\ k\in\Z_+$, существуют такие константы $c_\alpha\in\F$, для которых $|\a|\le k$ и
\[
  f(x) = \sum\limits_{|\a|\le k}c_\a\dl^\a\delta(x-a).
\]
\end{The}
Любая такая функция есть линейная комбинация дельта-функции и её производных. До некоторого конечного порядка.


\subsection{Задача существования первообразной обобщённой функции}
Рассмотрим случай $\R^m=\R$. Первообразная определяется как обычно: такая функция, что обобщённая производная равна заданной.

Вначале докажем лемму.
\begin{Lem}
 Если $f\in\D'(a,b)$ и её обобщённая производная $\dl f = 0$, то $f=c\in\F$ на интервале $(a,b)$.
\end{Lem}
\begin{Proof}
  Запишем условие того, что обобщённая производная равна нулю. Это означает, что для всех $\phi\in \D(a,b)$ имеет место $\la f,\phi'\ra=0$. Рассмотрим два подпространства в $\D(a,b)$.
\begin{itemize}
\item $L:=\big\{\phi\in\D(a,b)\bigm|\int\limits_{a}^b\phi\,dx=0\big\}$;
\item $M:=\big\{\phi\in\D(a,b)\bigm|\exists\ \psi\in\D(a,b)\colon \psi'=\phi\big\}$.
\end{itemize}
Оказывается, что эти подпространства равны. Если $\phi\in M$, то $\int\limits_a^b\phi\,dx = \psi(b)-\psi(a) = 0$ и $\phi\in L$.

Обратно. Пусть $\phi\in L$. Тогда $\psi(x):=\int\limits_a^x\phi(t)\,dt$, $\psi'=\phi$, $\psi\in\D(a,b)$.

Таким образом, $L=M$.

Рассмотрим теперь произвольную функцию $\eta\in\D(a,b)$, у которой интеграл $\int\limits_a^b \eta(t)\,dt = 1$. Тогда
\[
  \forall\ \phi\in\D(a,b)\pau \psi := \phi -\eta\int\limits_a^b\phi(t)\,dt.
\]
Значит, $\phi$ произвольная, а вот оказывается $\psi\in L$. Применяем этот функционал к нашем равенству $\la f,\phi'\ra=0$.
\[
  \la f,\phi\ra = \underbrace{\la f,\eta}_{c}\ra\int\limits_a^b\phi(t)\,dt.
\]
Тогда $\forall\ \phi\in\D(a, b)\pau \la f,\phi\ra = \la c,\phi\ra$.
\end{Proof}

\begin{The}[о существовании первообразной]
  $\forall\ f\in\D'(a,b)\pau\exists\ g\in \D'(a,b)\colon \dl g=f$.
\end{The}
\begin{Proof}
  Определим функционал $g$ на подпространстве $M$ по формуле
\[
  \forall\ \phi\in \D(a,b)\pau \la g,\phi'\ra = -\la f,\phi\ra.
\]
$g$ определён только на производных, поэтому он определён только на подпространстве. Зафиксируем произвольную $\phi\in D(a,b)$ и произвольную $\eta\in M$, найдём $\psi\in M$, для которой
\[
  \phi = \psi +\eta\int\limits_a^b\phi(t)\,dt,\quad \psi\in M=L.
\]
Можем продолжить функционал с $M$ на всё пространство $\D(a,b)$ вот по такой формуле
\[
  \la g,\phi\ra := \la g,\psi\ra + \underbrace{\la g,\eta\ra}_{c}\int\limits_a^b\phi(t)\,dt = -\la f,A\phi\ra + \la c,\phi\ra.
\]
При этом $A$ задан формулой
\[
  A\phi(x) = \int\limits_a^x\bigg(\phi-\eta\int\limits_a^b\phi(t)\,dt\bigg)\,dy.
\]
Легко проверить, что раз оператор $A$ непрерывен на $\D(a,b)$, то и оператор $g$ будет непрерывен. И также видно, что $\dl g=f$.
\end{Proof}
